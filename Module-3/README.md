# MiniTorch Module 3

<img src="https://minitorch.github.io/minitorch.svg" width="50%">

* Docs: https://minitorch.github.io/

* Overview: https://minitorch.github.io/module3.html


You will need to modify `tensor_functions.py` slightly in this assignment.

* Tests:

```
python run_tests.py
```

* Note:

Several of the tests for this assignment will only run if you are on a GPU machine and will not
run on github's test infrastructure. Please follow the instructions to setup up a colab machine
to run these tests.

This assignment requires the following files from the previous assignments. You can get these by running

```bash
python sync_previous_module.py previous-module-dir current-module-dir
```

The files that will be synced are:

        minitorch/tensor_data.py minitorch/tensor_functions.py minitorch/tensor_ops.py minitorch/operators.py minitorch/module.py minitorch/autodiff.py minitorch/module.py project/run_manual.py project/run_scalar.py project/run_tensor.py

## Task 3.1 and 3.2

[Results of the Parallel Check](https://github.com/Cornell-Tech-ML/mle-module-3-WDaugherty/blob/master/parallel_check_outputs)


## Task 3.4

Find below the comparison graph between the CPU and GPU backends that was generate from the output of the timing.py file provided by Justin.

<img src="img/Size_Comp.png">

We note that in the beginning the CPU and GPU are similiar however as size increase, the CPU take more time meanwhile the GPU is faster. It should be pointed out that this graph is not in log scale however it is not necessary.

Below is the output generated by the script and there is a text file contianing the same information within this repo.

<img src="img/Timing_Output.png">


## Task 3.5

For this task, there will be four subsections each containing the four datasets (simple, split, diagonal and xor) and a fith containing the large model for both the CPU and GPU with size set to 200. Note all in every subsection, we obtained 100% accuracy as all 50 points are correctly classified. 

### CPU with Streamlit

Note this was run with the intention of being a proof of concept and so I did not include the logs for these since the streamlit was optional. Also there is the addition of the circle dataset (ran out of time to get the spiral completly right).


#### Simple Accuracy 50/50 Time per Epoch 0.063
<img src="img/Streamlit/Simple_1.png">

<img src="img/Streamlit/Simple_2.png">

<img src="img/Streamlit/Simple_3.png">

<img src="img/Streamlit/Simple_4.png">

#### Diagonal Accuracy 50/50 Time per Epoch 0.066

<img src="img/Streamlit/Diag_1.png">

<img src="img/Streamlit/Diag_2.png">

<img src="img/Streamlit/Diag_3.png">

<img src="img/Streamlit/Diag_4.png">

#### Split Accuracy 50/50 Time per Epoch 0.060

<img src="img/Streamlit/Split_1.png">

<img src="img/Streamlit/Split_2.png">

<img src="img/Streamlit/Split_3.png">

<img src="img/Streamlit/Split_4.png">

#### Xor Accuracy 50/50 Time per Epoch 0.063

<img src="img/Streamlit/Xor_1.png">

<img src="img/Streamlit/Xor_2.png">

<img src="img/Streamlit/Xor_3.png">

<img src="img/Streamlit/Xor_4.png">

#### Circle Accuracy 50/50 Time per Epoch 0.063

<img src="img/Streamlit/Circ_1.png">

<img src="img/Streamlit/Circ_2.png">

<img src="img/Streamlit/Circ_3.png">

<img src="img/Streamlit/Circ_4.png">


### CPU with Google Colab

#### Simple Accuracy 50/50 Time per Epoch 0.33766
<img src="img/CPU_Colab/Simple_1.png">

<img src="img/CPU_Colab/Simple_2.png">

#### Diagonal Accuracy 50/50 Time per Epoch 0.3374
<img src="img/CPU_Colab/Diag_1.png">

<img src="img/CPU_Colab/Diag_2.png">

#### Split Accuracy 50/50 Time per Epoch 0.3951
<img src="img/CPU_Colab/Split_1.png">

<img src="img/CPU_Colab/Split_2.png">

#### Xor Accuracy 50/50 Time per Epoch 0.3249
<img src="img/CPU_Colab/Xor_1.png">

<img src="img/CPU_Colab/Xor_2.png">


[Results](https://github.com/Cornell-Tech-ML/mle-module-3-WDaugherty/blob/master/terminal_ouputs/CPU_Colab_Logs)
### GPU with Google Colab (Hidden Size 100)

#### Simple Accuracy 50/50 Time per Epoch 2.065
<img src="img/GPU_100/Simple_1.png">

<img src="img/GPU_100/Simple_2.png">

<img src="img/GPU_100/Simple_3.png">

#### Diagonal Accuracy 50/50 Time per Epoch 2.001
<img src="img/GPU_100/Diag_1.png">

<img src="img/GPU_100/Diag_2.png">

<img src="img/GPU_100/Diag_3.png">

#### Split Accuracy 50/50 Time per Epoch 2.0144
<img src="img/GPU_100/Split_1.png">

<img src="img/GPU_100/Split_2.png">

<img src="img/GPU_100/Split_3.png">

#### Xor Accuracy 50/50 Time per Epoch 2.0180
<img src="img/GPU_100/Xor_1.png">

<img src="img/GPU_100/Xor_2.png">

<img src="img/GPU_100/Xor_3.png">

[Results](https://github.com/Cornell-Tech-ML/mle-module-3-WDaugherty/blob/master/terminal_ouputs/GPU_Colab_100)
### GPU with Google Colab (Hidden Size 500)

#### Simple Accuracy 50/50 Time per Epoch 2.662
<img src="img/GPU_500/Simple_1.png">

<img src="img/GPU_500/Simple_2.png">

<img src="img/GPU_500/Simple_3.png">

#### Diagonal Accuracy 50/50 Time per Epoch 2.607
<img src="img/GPU_500/Diag_1.png">

<img src="img/GPU_500/Diag_2.png">

<img src="img/GPU_500/Diag_3.png">

#### Split Accuracy 50/50 Time per Epoch 2.611
<img src="img/GPU_500/Split_1.png">

<img src="img/GPU_500/Split_2.png">

<img src="img/GPU_500/Split_3.png">

#### Xor Accuracy 50/50 Time per Epoch 2.622
<img src="img/GPU_500/Xor_1.png">

<img src="img/GPU_500/Xor_2.png">

<img src="img/GPU_500/Xor_3.png">

[Results](https://github.com/Cornell-Tech-ML/mle-module-3-WDaugherty/blob/master/terminal_ouputs/GPU_Colab_500)

### Large

#### Xor CPU Large Accuracy 50/50 Time per Epoch 0.2819

<img src="img/CPU_Large_1.png">

<img src="img/CPU_Large_2.png">


#### Xor GPU Large Accuracy 50/50 Time per Epoch 2.2169


<img src="img/GPU_Large_1.png">

<img src="img/GPU_Large_2.png">

<img src="img/GPU_Large_3.png">

[Results](https://github.com/Cornell-Tech-ML/mle-module-3-WDaugherty/blob/master/terminal_ouputs/Large)